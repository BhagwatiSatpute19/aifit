<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Outfit Suggestion</title>
  <link rel="stylesheet" href="outfit.css" />
</head>
<body>
  <h1>Welcome</h1>

  <div class="container">
    <label>Name</label><br>
    <input type="text" name="name" placeholder="e.g., Alia" /><br><br>

    <label for="gender">Gender:</label><br>
    <select id="gender" name="gender">
      <option value="male">Male</option>
      <option value="female">Female</option>
      <option value="other">Other</option>
    </select><br><br>

    <label for="height">Height (ft):</label><br>
    <input type="number" id="height" name="height" min="1" max="10" step="0.1" placeholder="e.g., 5.8" /><br><br>

    <label for="weight">Weight (kg):</label><br>
    <input type="number" id="weight" name="weight" min="1" step="0.1" placeholder="e.g., 65" /><br><br>

    <label for="bodytype">Body Type:</label><br>
    <select id="bodytype" name="bodytype">
      <option value="hourglass">Hourglass</option>
      <option value="pear">Pear</option>
      <option value="apple">Apple</option>
      <option value="rectangle">Rectangle</option>
      <option value="inverted triangle">Inverted Triangle</option>
      <option value="triangle">Triangle</option>
      <option value="oval">Oval</option>
      <option value="trapezoid">Trapezoid</option>
    </select><br><br>

    <label for="skinTone">Skin Tone:</label><br>
    <select id="skinTone" name="skinTone">
      <option value="fair">Fair</option>
      <option value="medium">Medium</option>
      <option value="olive">Olive</option>
      <option value="brown">Brown</option>
      <option value="dark">Dark</option>
    </select><br><br>

    <label for="occasion">Occasion:</label><br>
    <select id="occasion" name="occasion">
      <option value="casual">Casual</option>
      <option value="formal">Formal</option>
      <option value="party">Party</option>
      <option value="wedding">Wedding</option>
      <option value="interview">Interview</option>
      <option value="vacation">Vacation</option>
    </select><br><br>

    <label for="mood">Mood:</label><br>
    <select id="mood" name="mood">
      <option value="happy">Happy</option>
      <option value="calm">Calm</option>
      <option value="bold">Bold</option>
      <option value="lazy">Lazy</option>
      <option value="romantic">Romantic</option>
    </select><br><br>

    <button>Get Outfit</button>
  </div>

  <div id="output" style="padding: 20px;"></div>

  <script>
    const GEMINI_API_KEY = "AIzaSyBgDE-Y2gifFt9P6RHE9ndeVtJIkgX24A4";
    const UNSPLASH_ACCESS_KEY = "GEfFhY8toFSyswLyUQ5SwgRusqWUhwYkYRi9NCKanK0";

    document.addEventListener("DOMContentLoaded", () => {
      const button = document.querySelector("button");

      button.addEventListener("click", async () => {
        const name = document.querySelector("input[name='name']").value;
        const gender = document.getElementById("gender").value;
        const height = document.getElementById("height").value;
        const weight = document.getElementById("weight").value;
        const bodyType = document.getElementById("bodytype").value;
        const skinTone = document.getElementById("skinTone").value;
        const occasion = document.getElementById("occasion").value;
        const mood = document.getElementById("mood").value;

        if (!name || !height || !weight) {
          alert("Please fill out all required fields.");
          return;
        }

        const user = { name, gender, height, weight, bodyType, skinTone, occasion, mood };

        document.getElementById("output").innerHTML = `<h2>Hi ${name}!</h2><p>Getting your outfit suggestion...</p>`;

        try {
          const suggestion = await getOutfitSuggestion(user);
          const imageUrl = await getImageFromUnsplash(user);

          document.getElementById("output").innerHTML = `
            <h2>Hi ${name}!</h2>
            <p><strong>Suggested Outfit:</strong><br>${suggestion}</p>
            <img src="${imageUrl}" alt="Outfit Image" style="max-width: 100%; color:"white" margin-top: 10px;" onerror="this.src='default.webp';"/>
          `;
        } catch (error) {
          console.error("Error:", error);
          document.getElementById("output").innerHTML = `<p>Something went wrong. Please try again later.</p>`;
        }
      });
    });

    async function getOutfitSuggestion(user) {
      const prompt = `
Suggest a fashionable outfit for the following:
- Gender: ${user.gender}
- Height: ${user.height} ft
- Weight: ${user.weight} kg
- Body Type: ${user.bodyType}
- Skin Tone: ${user.skinTone}
- Occasion: ${user.occasion}
- Mood: ${user.mood}
Be creative and specific with clothing suggestions (like top, bottom, shoes, accessories).
`;

      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            contents: [{ parts: [{ text: prompt }] }],
          }),
        }
      );

      const data = await res.json();
      return data?.candidates?.[0]?.content?.parts?.[0]?.text?.trim() || "here it is";
    }

    async function getImageFromUnsplash(user) {
      const keywords = `${user.gender}, ${user.occasion}, ${user.mood}, fashion outfit`;
      const url = `https://api.unsplash.com/search/photos?query=${encodeURIComponent(keywords)}&per_page=1&client_id=${UNSPLASH_ACCESS_KEY}`;

      const res = await fetch(url);
      const data = await res.json();
      return data?.results?.[0]?.urls?.regular || "https://via.placeholder.com/400x300?text=No+Image+Found";
    }
  </script>
  <script>
document.addEventListener("DOMContentLoaded", () => {
  const button = document.querySelector("button");

  button.addEventListener("click", async () => {
    // Collect user inputs
    const name = document.querySelector("input[name='name']").value.trim();
    const gender = document.getElementById("gender").value;
    const height = document.getElementById("height").value.trim();
    const weight = document.getElementById("weight").value.trim();
    const bodyType = document.getElementById("bodytype").value;
    const skinTone = document.getElementById("skinTone").value;
    const occasion = document.getElementById("occasion").value;
    const mood = document.getElementById("mood").value;

    // Validate required fields
    if (!name || !height || !weight) {
      alert("Please fill out all required fields: Name, Height, and Weight.");
      return;
    }

    // Create user data object
    const userData = {
      name,
      gender,
      height,
      weight,
      bodyType,
      skinTone,
      occasion,
      mood,
    };

    // Show loading message
    const output = document.getElementById("output");
    output.innerHTML = `<h2>Hi ${name}!</h2><p>Generating your personalized outfit suggestion, please wait...</p>`;

    try {
      // Get AI-generated outfit suggestion
      const suggestion = await getOutfitSuggestion(userData);

      // Get relevant outfit image from Unsplash
      const imageUrl = await getImageFromUnsplash(userData);

      // Display result
      output.innerHTML = `
        <h2>Hi ${name}!</h2>
        <p><strong>Suggested Outfit for ${occasion} (Mood: ${mood}):</strong><br>${suggestion}</p>
        <img src="${imageUrl}" alt="Outfit Suggestion" style="max-width: 100%; border-radius: 10px; margin-top: 15px;" onerror="this.src='default.webp';"/>
      `;
    } catch (error) {
      // Handle errors gracefully
      output.innerHTML = `<p>Sorry, something went wrong while fetching your outfit suggestion. Please try again later.</p>`;
      console.error("API Error:", error);
    }
  });
});

// Your Gemini API Key
const GEMINI_API_KEY = "AIzaSyBgDE-Y2gifFt9P6RHE9ndeVtJIkgX24A4";

// Your Unsplash API Access Key
const UNSPLASH_ACCESS_KEY = "GEfFhY8toFSyswLyUQ5SwgRusqWUhwYkYRi9NCKanK0";

// Function to get outfit suggestion using Gemini
async function getOutfitSuggestion(user) {
  const prompt = `
You are a fashion expert. Suggest a complete stylish outfit for the following person:
- Gender: ${user.gender}
- Height: ${user.height} ft
- Weight: ${user.weight} kg
- Body Type: ${user.bodyType}
- Skin Tone: ${user.skinTone}
- Occasion: ${user.occasion}
- Mood: ${user.mood}

Be specific with clothing items, including type of top, bottom, footwear, and accessories that would suit the personâ€™s style and physical traits. Provide the recommendation in clear and concise bullet points.
`;

  const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`, {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      contents: [{ parts: [{ text: prompt }] }]
    })
  });

  const data = await response.json();
  const suggestion = data?.candidates?.[0]?.content?.parts?.[0]?.text?.trim();
  return suggestion || "Unable to fetch outfit suggestion.";
}

// Function to fetch relevant fashion image using Unsplash
async function getImageFromUnsplash(user) {
  // Construct query for image search
  const keywords = `${user.gender}, ${user.occasion}, ${user.mood}, fashion outfit`;
  const encodedQuery = encodeURIComponent(keywords);

  const url = `https://api.unsplash.com/search/photos?query=${encodedQuery}&per_page=1&client_id=${UNSPLASH_ACCESS_KEY}`;

  const response = await fetch(url);
  const data = await response.json();
  return data?.results?.[0]?.urls?.regular || "https://via.placeholder.com/400x300?text=No+Image+Found";
}
</script>

</body>
</html>
